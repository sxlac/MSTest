BEGIN TRANSACTION;

--Create temporary table to store FOBTId for expired kits.
CREATE TEMPORARY TABLE "tmp_expired_kits" ("FOBTId" integer NOT NULL);

--Insert FOBTId of expired kits in temporary table
INSERT INTO
  "tmp_expired_kits" ("FOBTId")
Select
  "FOBTId"
from
  "FOBT"
where
  "EvaluationId" in (
    --Put evaluationIds for expired kits here (EvaluationIds mentioned in the excel sheet attached to the ticket. Using those here)
    11310420,
    11310866,
    11310874,
    11313604,
    11316579,
    11316821,
    11321796,
    11323813,
    11325848,
    11326956,
    11327001,
    11328369,
    11329658,
    11332391,
    11334172,
    11334425,
    11338475,
    11341064,
    11344079,
    11351035,
    11354477,
    11354955,
    11355064,
    11355090,
    11356876,
    11359202,
    11359417,
    11360242,
    11361604,
    11366135,
    11367610,
    11367917,
    11369429,
    11369814,
    11370181,
    11371084,
    11372022,
    11372267,
    11372430,
    11373255,
    11373352,
    11373385,
    11373390,
    11373554,
    11373772,
    11374271,
    11376151,
    11376925,
    11377060,
    11377142,
    11377534,
    11377639,
    11378059,
    11378569,
    11378730,
    11379580,
    11380567,
    11380772,
    11381253,
    11381993,
    11382398,
    11383135,
    11383231,
    11383357,
    11383636,
    11383926,
    11383927,
    11384242,
    11384400,
    11384709,
    11384831,
    11385774,
    11385906,
    11387812,
    11388610,
    11388621,
    11388695,
    11389002,
    11389207,
    11389841,
    11390249,
    11390372,
    11390448,
    11390578,
    11390662,
    11390759,
    11391320,
    11391370,
    11391380,
    11392551,
    11392879,
    11393019,
    11393065,
    11393664,
    11393682,
    11393710,
    11393799,
    11394479,
    11394492,
    11394508,
    11395168,
    11395848,
    11396171,
    11396330,
    11397126,
    11397622,
    11397632,
    11399585,
    11400208,
    11400502,
    11401427,
    11402752,
    11403268,
    11403705,
    11403807,
    11404526,
    11405865,
    11406118,
    11406844,
    11406852,
    11407022,
    11407225,
    11407358,
    11407419,
    11407472,
    11408104,
    11409217,
    11409933,
    11409990,
    11410019,
    11410109,
    11410126,
    11410245,
    11410686,
    11410719,
    11410990,
    11411002,
    11412189,
    11412233,
    11412283,
    11412647,
    11412921,
    11412933,
    11413037,
    11413646,
    11413904,
    11414165,
    11415236,
    11415680,
    11416188,
    11416596,
    11416889,
    11417102,
    11417294,
    11418101,
    11418262,
    11418689,
    11419027,
    11419663,
    11420263,
    11420602,
    11420810,
    11421086,
    11421154,
    11421313,
    11421951,
    11422735,
    11423450,
    11425007,
    11425218,
    11425640,
    11425775,
    11426220,
    11426378,
    11426399,
    11426556,
    11426892,
    11427096,
    11427108,
    11427129,
    11427153,
    11427410,
    11427855,
    11428419,
    11428538,
    11428739,
    11429253,
    11429532,
    11429602,
    11430626,
    11430671,
    11431574,
    11431952,
    11432062,
    11432474,
    11433497,
    11434239,
    11435051,
    11435142,
    11435149,
    11435299,
    11435629,
    11435948,
    11436248,
    11436669,
    11436881,
    11437417,
    11437873,
    11438756,
    11438762,
    11439199,
    11439219,
    11439482,
    11439742,
    11440144,
    11440558,
    11440786,
    11441092,
    11441107,
    11441108,
    11442630,
    11442958,
    11443470,
    11443832,
    11446631,
    11446779,
    11446888,
    11447414,
    11448095,
    11448358,
    11448734,
    11449313,
    11450466,
    11450645,
    11450735,
    11450915,
    11451187,
    11451561,
    11451771,
    11451858,
    11451955,
    11452108,
    11452535,
    11453060,
    11453175,
    11453329,
    11453496,
    11453817,
    11454194,
    11455061,
    11456597,
    11456995,
    11457028,
    11457383,
    11457423,
    11458576,
    11459278,
    11459862,
    11460095,
    11460175,
    11461349,
    11461430,
    11461728,
    11462044,
    11462759,
    11462777,
    11463165,
    11463264,
    11463477,
    11463496,
    11463869,
    11464292,
    11464377,
    11464475,
    11464588,
    11464805,
    11465478,
    11465491,
    11466522,
    11467041,
    11467841,
    11468680,
    11470042,
    11470845,
    11472442,
    11474792,
    11476175,
    11480721,
    11486641,
    11493617,
    11505060,
    11505075,
    11505459,
    11507650,
    11523369,
    11525643,
    11525691,
    11530816,
    11531080,
    11531379,
    11532744,
    11535036,
    11536277,
    11536460,
    11537349,
    11537481,
    11537766,
    11538357,
    11538957,
    11538961,
    11539118,
    11539483,
    11540293,
    11540636,
    11541995,
    11543198,
    11543452,
    11543533,
    11543553,
    11544013,
    11544249,
    11544485,
    11544669,
    11544812,
    11544904,
    11545273,
    11545490,
    11546047,
    11546051,
    11547451,
    11549098,
    11549623,
    11549870,
    11550723,
    11551372,
    11551419,
    11551738,
    11551880,
    11553142,
    11553936,
    11555312,
    11555932,
    11556201,
    11556944,
    11557441,
    11557993,
    11558369,
    11559413,
    11560085,
    11560798,
    11561349,
    11562151,
    11562254,
    11562587,
    11562957,
    11564414,
    11564825,
    11565047,
    11567902,
    11568245,
    11568717,
    11568910,
    11569529,
    11569763,
    11570121,
    11570272,
    11570593,
    11570948,
    11571209,
    11572030,
    11572045,
    11574031,
    11574076,
    11574255,
    11574433,
    11575704,
    11575782,
    11575923,
    11576270,
    11578235,
    11580325,
    11581076,
    11582428,
    11584047,
    11584104,
    11584281,
    11584929,
    11585049,
    11586187,
    11586406,
    11586488,
    11586901,
    11587853,
    11588180,
    11588485,
    11588544,
    11588622,
    11589177,
    11590093,
    11590135,
    11590247,
    11590390,
    11590643,
    11591058,
    11591512,
    11592686,
    11592730,
    11595064,
    11595280,
    11595650,
    11595997,
    11597632,
    11597935,
    11598138,
    11599033,
    11600870,
    11601180,
    11602172,
    11602347,
    11602564,
    11603039,
    11603204,
    11605158,
    11606046,
    11606277,
    11606508,
    11607024,
    11607480,
    11607609,
    11607810,
    11607919,
    11608114,
    11608785,
    11610390,
    11610706,
    11610794,
    11611222,
    11611526,
    11612621,
    11612901,
    11612999,
    11613237,
    11613813,
    11613847,
    11614108,
    11614733,
    11614806,
    11615362,
    11616192,
    11617733,
    11619600,
    11619936,
    11620237,
    11620401,
    11620504,
    11621665,
    11622100,
    11622273,
    11622332,
    11622700,
    11623298,
    11623489,
    11624308,
    11625442,
    11625898,
    11626536,
    11627627,
    11628535,
    11628826,
    11629332,
    11630925,
    11631396,
    11631798,
    11631959,
    11632213,
    11632568,
    11633440,
    11633550,
    11633695,
    11633958,
    11634150,
    11634976,
    11635453,
    11635890,
    11638893,
    11639022,
    11639958,
    11640017,
    11640402,
    11642238,
    11642282,
    11642632,
    11643239,
    11644447,
    11644495,
    11644915,
    11646399,
    11646804,
    11648044,
    11648102,
    11648533,
    11649041,
    11649238,
    11649937,
    11650039,
    11651258,
    11651373,
    11652256,
    11652437,
    11652515,
    11652746,
    11654484,
    11654585,
    11655126,
    11655887,
    11655926,
    11656785,
    11657151,
    11657370,
    11657416,
    11657423,
    11657433,
    11659331,
    11661242,
    11661845,
    11662598,
    11663964,
    11665611,
    11665919,
    11667063,
    11667329,
    11668431,
    11668893,
    11669017,
    11669146,
    11669347,
    11669631,
    11669863,
    11670198,
    11671221,
    11671669,
    11672722,
    11674514,
    11674517,
    11674736,
    11675103,
    11675212,
    11675323,
    11675761,
    11675901,
    11677067,
    11677295,
    11677940,
    11678211,
    11678793,
    11679475,
    11680739,
    11681996,
    11682575,
    11683061,
    11685142,
    11685747,
    11688431,
    11688506,
    11688649,
    11690336,
    11691404,
    11691774,
    11691888,
    11692011,
    11692346,
    11692376,
    11692714,
    11693809,
    11694550,
    11696792,
    11697601,
    11697636,
    11698219,
    11698275,
    11698773,
    11699744,
    11701676,
    11702198,
    11702861,
    11703131,
    11703266,
    11704279,
    11704526,
    11704627,
    11704811,
    11705177,
    11705234,
    11705276,
    11705854,
    11708355,
    11708737,
    11709069,
    11709192,
    11709365,
    11709548,
    11709855,
    11709986,
    11710098,
    11710327,
    11711704,
    11711846,
    11712275,
    11714251,
    11714797,
    11715644,
    11715652,
    11718301,
    11719409,
    11720716,
    11720725,
    11720821,
    11722374,
    11722469,
    11722559,
    11722957,
    11724970,
    11733596,
    11734796,
    11735144,
    11737280,
    11738768,
    11739012,
    11739866,
    11740253,
    11740675,
    11741191,
    11741975,
    11742193,
    11742539,
    11742754,
    11743194,
    11743997,
    11744358,
    11744542,
    11744725,
    11745323,
    11746983,
    11747150,
    11749848,
    11749933,
    11751582,
    11752440,
    11752693,
    11753164,
    11754172,
    11754554,
    11755297,
    11756174,
    11756340,
    11756586,
    11757435,
    11757495,
    11757901,
    11757980,
    11758273,
    11758720,
    11759532,
    11763318,
    11763321,
    11763882,
    11763969,
    11764427,
    11764775,
    11765281,
    11766128,
    11766488,
    11766803,
    11766870,
    11767325,
    11768609,
    11768799,
    11769033,
    11769144,
    11769354,
    11769834,
    11770221,
    11770241,
    11771207,
    11772010,
    11772203,
    11774504,
    11774761,
    11775584,
    11777365,
    11778350,
    11780295,
    11780477,
    11782469,
    11782856,
    11783929,
    11784197,
    11784359,
    11785265,
    11785613,
    11786140,
    11786353,
    11786742,
    11787708,
    11788521,
    11789295,
    11789336,
    11789829,
    11790281,
    11790343,
    11791295,
    11791725,
    11793640,
    11793914,
    11794700,
    11795243,
    11795655,
    11796168,
    11796854,
    11796995,
    11798914,
    11799447,
    11799554,
    11799923,
    11801929,
    11803465,
    11804862,
    11805183,
    11806400,
    11807942,
    11807981,
    11808517,
    11808823,
    11808839,
    11810500,
    11810568,
    11810627,
    11811359,
    11811571,
    11811687,
    11812051,
    11812429,
    11812452,
    11812499,
    11812628,
    11813158,
    11813374,
    11814921,
    11815571,
    11815926,
    11817268,
    11817315,
    11818030,
    11819379,
    11820393,
    11821063,
    11821373,
    11821413,
    11821419,
    11821825,
    11821898,
    11822403,
    11823409,
    11823768,
    11826078,
    11827144,
    11827591,
    11827720,
    11828372,
    11828798,
    11828835,
    11829656,
    11830042,
    11831305,
    11831834,
    11832265,
    11832666,
    11832991,
    11833301,
    11833762,
    11834017,
    11834089,
    11834171,
    11834735,
    11834874,
    11835542,
    11836068,
    11836327,
    11838153,
    11838489,
    11838959,
    11838964,
    11839434,
    11840057,
    11840779,
    11843792,
    11844264,
    11844829,
    11845385,
    11845701,
    11845934,
    11846352,
    11846768,
    11847191,
    11847809,
    11847848,
    11848574,
    11849108,
    11849722,
    11849911,
    11851733,
    11853694,
    11854441,
    11855487,
    11855565,
    11856112,
    11856851,
    11860151,
    11860539,
    11861830,
    11862194,
    11862626,
    11863241,
    11864007,
    11864216,
    11866871,
    11867104,
    11867121,
    11867190,
    11867219,
    11867262,
    11867471,
    11867608,
    11868124,
    11869000,
    11869877,
    11870100,
    11870702,
    11870890,
    11870977,
    11871292,
    11872254,
    11872545,
    11872734,
    11873594,
    11875261,
    11875376,
    11877036,
    11877201,
    11877352,
    11877670,
    11878272,
    11878364,
    11878594,
    11879590,
    11881329,
    11881403,
    11882387,
    11883358,
    11883675,
    11884223,
    11884830,
    11885233,
    11885288,
    11885502,
    11886294,
    11886568,
    11887008,
    11887191,
    11887271,
    11888745,
    11889367,
    11889468,
    11889497,
    11889685,
    11890346,
    11890640,
    11892595,
    11893203,
    11893455,
    11895370,
    11898863,
    11900630,
    11901086,
    11901298,
    11901988,
    11902171,
    11902700,
    11902925,
    11903806,
    11903987,
    11904409,
    11906525,
    11908563,
    11909103,
    11910206,
    11910723,
    11913886,
    11914017,
    11915465,
    11915676,
    11915905,
    11917577,
    11917765,
    11917984,
    11918103,
    11918803,
    11919476,
    11919767,
    11919960,
    11920006,
    11920313,
    11920456,
    11921375,
    11923175,
    11923570,
    11924700,
    11924909,
    11925374,
    11925411,
    11925816,
    11926198,
    11927497,
    11927877,
    11928188,
    11930409,
    11930667,
    11931996,
    11933507,
    11936824,
    11937682,
    11938247,
    11939284,
    11941339,
    11943234,
    11943303,
    11943814,
    11944183,
    11944743,
    11945603,
    11947125,
    11948528,
    11950673,
    11953690,
    11954581,
    11954704,
    11956726,
    11958881,
    11959265,
    11960138,
    11961224,
    11962747,
    11962752,
    11964068,
    11964876,
    11965073,
    11965100,
    11966670,
    11966748,
    11968950,
    11968953,
    11969659,
    11970714,
    11970749,
    11971136,
    11971604,
    11972700,
    11972900,
    11975356,
    11976147,
    11979493,
    11982582,
    11982593,
    11982953,
    11983153,
    11983785,
    11986306,
    11988506,
    11988981,
    11989134,
    11989449,
    11990743,
    11991323,
    11992058,
    11993348,
    11998038,
    11999559,
    12001315,
    12001827,
    12002770,
    12003443,
    12003792,
    12003929,
    12004731,
    12004769,
    12005208,
    12006527,
    12007695,
    12010594,
    12010963,
    12011111,
    12011329,
    12011743,
    12012585,
    12012870,
    12013679,
    12014065,
    12014109,
    12014145,
    12014300,
    12014518,
    12014741,
    12014954,
    12015814,
    12016296,
    12017967,
    12017979,
    12018031,
    12018081,
    12018785,
    12019604,
    12020557,
    12020748,
    12020870,
    12021750,
    12022295,
    12022863,
    12023178,
    12023213,
    12023343,
    12023903,
    12024329,
    12024748,
    12024798,
    12027476,
    12028019,
    12028490,
    12028631,
    12028789,
    12029619,
    12029896,
    12031078,
    12032306,
    12033852,
    12038891,
    12039117,
    12039543,
    12039548,
    12040200,
    12040208,
    12040630,
    12040635,
    12041865,
    12042528,
    12049071,
    12049111,
    12050485,
    12050876,
    12051602,
    12052750,
    12053042,
    12054854,
    12055660,
    12055843,
    12055856,
    12056464,
    12057610,
    12061599,
    12061733,
    12062335,
    12063422,
    12063944,
    12066496,
    12067251,
    12068240,
    12068280,
    12068854,
    12069505,
    12070415,
    12070830,
    12072408,
    12073769,
    12077518,
    12079799,
    12080837,
    12080873,
    12081861,
    12081950,
    12082197,
    12082780,
    12083651,
    12083656,
    12084096,
    12084440,
    12084634,
    12087598,
    12088320,
    12088891,
    12089737,
    12091140,
    12091520,
    12091783,
    12093387,
    12093436,
    12093759,
    12093834,
    12094162,
    12094548,
    12094893,
    12097251,
    12098056,
    12098288,
    12098816,
    12099708,
    12099882,
    12100360,
    12100784,
    12101164,
    12103157,
    12103346,
    12103797,
    12104047,
    12104525,
    12104558,
    12105691,
    12105761,
    12106302,
    12106421,
    12106867,
    12107103,
    12107353,
    12107502,
    12108855,
    12109459,
    12110079,
    12110697,
    12111586,
    12112100,
    12112945,
    12112964,
    12114055,
    12114163,
    12116175,
    12117924,
    12118597,
    12120474,
    12121224,
    12121366,
    12121890,
    12122996,
    12123370,
    12123438,
    12124797,
    12125672,
    12126966,
    12128208,
    12128230,
    12129549,
    12130291,
    12131148,
    12131453,
    12131635,
    12131759,
    12132258,
    12132431,
    12133579,
    12135011,
    12135973,
    12135983,
    12136391,
    12137101,
    12138339,
    12138914,
    12139129,
    12139300,
    12139634,
    12139810,
    12140869,
    12141500,
    12141522,
    12141878,
    12142390,
    12142576,
    12143275,
    12145833,
    12146442,
    12146524,
    12146655,
    12149232,
    12150370,
    12150553,
    12150980,
    12156110,
    12156927,
    12157037,
    12158571,
    12159049,
    12159493,
    12160227,
    12161367,
    12161663,
    12163097,
    12164628,
    12165419,
    12166627,
    12166991,
    12167326,
    12168931,
    12170668,
    12170828,
    12173018,
    12174841,
    12175241,
    12175384,
    12175704,
    12176580,
    12177186,
    12177589,
    12178531,
    12178996,
    12179052,
    12179198,
    12179635,
    12180197,
    12182115,
    12182615,
    12184449,
    12184922,
    12186580,
    12186879,
    12187889,
    12188962,
    12189194,
    12192525,
    12193066,
    12194323,
    12195691,
    12199627,
    12201279,
    12201496,
    12202616,
    12202917,
    12205156,
    12205303,
    12207953,
    12210295,
    12210878,
    12212062,
    12213257,
    12213585,
    12213971,
    12216300,
    12216502,
    12219561,
    12219748,
    12220523,
    12221433,
    12223526,
    12225412,
    12225694,
    12226023,
    12226437,
    12227012,
    12228378,
    12231224,
    12232963,
    12233301,
    12233875,
    12234042,
    12235402,
    12236308,
    12238258,
    12239549,
    12240780,
    12241154,
    12243135,
    12243424,
    12245897,
    12247463,
    12247509,
    12247897,
    12249573,
    12249886,
    12249920,
    12250328,
    12250614,
    12254196,
    12255995,
    12259157,
    12259160,
    12259563,
    12260367,
    12262222,
    12262838,
    12263211,
    12267118,
    12267394,
    12268510,
    12270178,
    12270987,
    12272414,
    12272590,
    12275504,
    12275699,
    12276033,
    12276976,
    12277673,
    12279573,
    12283021,
    12283241,
    12285118,
    12285442,
    12286409,
    12288059,
    12288986,
    12289801,
    12291944,
    12292453,
    12292938,
    12293020,
    12293316,
    12293384,
    12293788,
    12293843,
    12296240,
    12297239,
    12297535,
    12298950,
    12300799,
    12300840,
    12305840,
    12309968,
    12310189,
    12310875,
    12313506,
    12313708,
    12315756,
    12316846,
    12317067,
    12321191,
    12323848,
    12331530,
    12332689,
    12333894,
    12335113,
    12335427,
    12335848,
    12336712,
    12337581,
    12339168,
    12342819,
    12343736,
    12343771,
    12343984,
    12344523,
    12344625,
    12345790,
    12346259,
    12350991,
    12355226,
    12355616,
    12356749,
    12357006,
    12357095,
    12357987,
    12358943,
    12359135,
    12359198,
    12362085,
    12362316,
    12364065,
    12364432,
    12364716,
    12365066,
    12366066,
    12369213,
    12371001,
    12372463,
    12374370,
    12377335,
    12378827,
    12382811,
    12383217,
    12383962,
    12384311,
    12386476,
    12388182,
    12388655,
    12391515,
    12393271,
    12393294,
    12394028,
    12396030,
    12398155,
    12398714,
    12404390,
    12405106,
    12405178,
    12405766,
    12409495,
    12413332,
    12419423,
    12419966,
    12424162,
    12435781,
    12439002,
    12441181,
    12441680,
    12445388,
    12448719,
    12452804,
    12453186,
    12456913,
    12459001,
    12469159,
    12479213,
    12492759,
    12509286,
    12598985
  );

-- Delete Previous LabResults records
DELETE FROM public."LabResults"
WHERE
  "LabResults"."FOBTId" IN (SELECT * FROM "tmp_expired_kits")
  AND "AbnormalIndicator" != 'U';

-- Remove lab Result valid status records (ValidLabResultsReceived)
DELETE FROM public."FOBTStatus"
WHERE
  "FOBTStatus"."FOBTId" IN (SELECT * FROM "tmp_expired_kits")
  AND "FOBTStatus"."FOBTStatusCodeId" = 7;

--Remove Bill Request sent status (FOBT-Results)
DELETE FROM public."FOBTStatus"
WHERE
  "FOBTStatus"."FOBTId" IN (SELECT * FROM "tmp_expired_kits")
  AND "FOBTStatus"."FOBTStatusCodeId" = 13;

--Remove Billing Information only for results received
DELETE FROM public."FOBTBilling"
WHERE
  "FOBTBilling"."FOBTId" IN (SELECT * FROM "tmp_expired_kits")
  AND "FOBTBilling"."BillingProductCode" = 'FOBT-Results';


COMMIT TRANSACTION;